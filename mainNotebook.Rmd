---
title: "R Notebook"
output: html_notebook
---

t

```{r}
supp<-function(X,values)
{
  count<-0
  n<-0
  flag=0
  if(is.null(dim(X)[1]))
  {
    n<-length(X)
    flag=1
  }
  else
    n<-dim(X)[1]
  for(i in seq(n))
  {
    if(flag==1)
      row<-X[i]
    else
      row<-X[i,]
    if(sum(row==values) == length(values))
      count=count+1
  }
  return(count/n)
}
x <- rbinom(n=10, size=1, prob=0.2)
ny<-rbinom(n=10, size=1, prob=0.05)
y <- x |  ny
supp(X=cbind(x,y),values=c(1,1) )

```
#Sorting
```{r}

vec2bin<-function(x)
{
  newx<-0
  d<-length(x)
  for(i in seq(d))
  {
    newx <- newx+x[i]*2^(d-i)
  }
  return(newx)
}
VecAlignment<-function(mat)
{
  # mat must have the dimension n by d where n and d must be greater than 1.
  newMat<-list()
  d<-dim(mat)[1]
  for(i in seq(d))
  {
    newMat[[sprintf("%d",vec2bin(mat[i,]))]]$name<-mat[i,]
    if(is.null(newMat[[sprintf("%d",vec2bin(mat[i,]))]]$count)==TRUE )
      newMat[[sprintf("%d",vec2bin(mat[i,]))]]$count<-1
    else
      newMat[[sprintf("%d",vec2bin(mat[i,]))]]$count<-newMat[[sprintf("%d",vec2bin(mat[i,]))]]$count+1
  }
  return(newMat)
}

n<-5000
d<-10
mat<-matrix(nrow=n,ncol=d)

for(i in seq(n))
{
  mat[i,] <- rbinom(n=d, size=1, prob=0.5)
}
mat[,1]<-mat[,2] | mat[,3]
mat[,4] <- mat[,2] | mat[,5]

D<-VecAlignment(mat)
```

#CondProb

```{r}
z<-numeric(d)-1
y<-numeric(d)-1
z[c(1,2)]<-1
y[2]<--1
CondProb<-function(D,y,z)
{
  p<-0
  filter<-z != -1
  if(sum(filter) == 0)
    nD<-D
  else
  {
    nD<-list()
    for(i in seq(length(D)) )
    {
      flag<-sum(D[[i]]$name[filter] == z[filter])
      if(flag == sum(filter))
      {
        nD[[names(D)[i] ]] <- D[[i]]
      }
    }
  }
  filterY<- y!= -1
  count<-0
  countTotal<-0
  for(i in seq(length(nD)) )
  {
    flag<-sum(nD[[i]]$name[filterY] == y[filterY])
    countTotal<-countTotal+nD[[i]]$count
    if(flag == sum(filterY))
    {
      count<-count+nD[[i]]$count
    }
  }
  
  return(list("condP"=count/countTotal, nD=nD,countTotal=countTotal,count=count ))
}
A<-CondProb(D,y,z)
```


#independent func
```{r}
#TODO add given z
indpFunc<-function(D,i,j,z=c())
{
  if(is.null(z))
    z<-numeric(d)-1
  
  res<-CondProb(D,y=numeric(d)-1,z=z)
  D<-res$nD
  n<-res$countTotal
  L<-length(D)
  
  indMagitude<-0
  
  z1<-numeric(d)-1

  for(i1 in c(0,1) )
    for(j1 in c(0,1))
    {
        y1<-numeric(d) -1
        y1[c(i,j)] <- c(i1,j1)
        y2<-numeric(d) -1
        y2[c(i)] <- i1
        y3<-numeric(d) -1
        y3[c(j)] <- j1
        
        res2<-CondProb(D,y1,z1)
        n2<-res2$count
        condPair<-res2$condP
        condi<-CondProb(D,y2,z1)$condP
        condj<-CondProb(D,y3,z1)$condP
        indMagitude<-indMagitude+ (abs(condPair - condi*condj)*(n2/n) )
    }
  
  return(indMagitude)
}
z<-numeric(d)-1
z[c(4,5)] = 1
indpFunc(D,1,3,z=z)
```
